dist: bionic
language: node_js

node_js:
  - "lts/*"

cache:
  directories:
    - "node_modules"
    - "seedutil/go" # go modules used for xudseed

jobs:
  include:
    - name: lintNoFix
      script:
        - npm run lintNoFix
    - name: test
      script:
        - npm run test
    - name: test:sim
      services:
        - docker
      script:
        - npm run test:sim:build
        - npm run test:sim:run
      after_failure:
        - npm run test:sim:logs
    - name: seedutil
      before_install:
        - eval "$(GIMME_GO_VERSION=1.13 gimme)"
      script:
        - npm run compile:seedutil
        - npm run test:seedutil
